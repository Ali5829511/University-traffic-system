<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø©</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            direction: rtl;
            padding: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .status {
            padding: 20px;
            background: #f0f0f0;
            border-radius: 10px;
            margin: 20px 0;
            min-height: 200px;
            max-height: 500px;
            overflow-y: auto;
        }
        .status p {
            margin: 10px 0;
            padding: 8px;
            border-right: 4px solid #4CAF50;
            background: white;
        }
        .status .error {
            border-right-color: #f44336;
        }
        .status .success {
            border-right-color: #4CAF50;
        }
        .status .info {
            border-right-color: #2196F3;
        }
        button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 20px;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ—„ï¸ ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ù„Ù„Ù†Ø¸Ø§Ù…</h1>
        <div class="status" id="status"></div>
        <button onclick="generateAllData()" id="generateBtn">ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
        <button onclick="window.location.href='home.html'" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    </div>

    <script src="residential_units_data.js"></script>
    <script>
        const statusDiv = document.getElementById('status');
        
        function addLog(message, type = 'info') {
            const p = document.createElement('p');
            p.className = type;
            p.textContent = message;
            statusDiv.appendChild(p);
            statusDiv.scrollTop = statusDiv.scrollHeight;
        }

        async function generateAllData() {
            const btn = document.getElementById('generateBtn');
            btn.disabled = true;
            statusDiv.innerHTML = '';
            
            try {
                addLog('ğŸš€ Ø¨Ø¯Ø¡ ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...', 'info');
                
                // 1. Initialize residential units
                addLog('ğŸ“Š ØªÙˆÙ„ÙŠØ¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙˆØ­Ø¯Ø§Øª Ø§Ù„Ø³ÙƒÙ†ÙŠØ©...', 'info');
                const dataManager = new ResidentialUnitsData();
                const units = dataManager.getAllUnits();
                addLog(`âœ“ ØªÙ… ØªÙˆÙ„ÙŠØ¯ ${units.length} ÙˆØ­Ø¯Ø© Ø³ÙƒÙ†ÙŠØ©`, 'success');
                
                // 2. Generate buildings data
                addLog('ğŸ¢ ØªÙˆÙ„ÙŠØ¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ...', 'info');
                const buildings = generateBuildingsData();
                localStorage.setItem('buildings', JSON.stringify(buildings));
                localStorage.setItem('buildingsData', JSON.stringify(buildings)); // For building_monitoring.html
                addLog(`âœ“ ØªÙ… ØªÙˆÙ„ÙŠØ¯ ${buildings.length} Ù…Ø¨Ù†Ù‰`, 'success');
                
                // 3. Generate parking data
                addLog('ğŸ…¿ï¸ ØªÙˆÙ„ÙŠØ¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ§Ù‚Ù...', 'info');
                const parking = generateParkingData();
                localStorage.setItem('parking', JSON.stringify(parking));
                localStorage.setItem('parkingData', JSON.stringify(parking)); // For parking_management.html
                addLog(`âœ“ ØªÙ… ØªÙˆÙ„ÙŠØ¯ ${parking.length} Ù…ÙˆÙ‚Ù`, 'success');
                
                // 4. Generate stickers data
                addLog('ğŸ·ï¸ ØªÙˆÙ„ÙŠØ¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù„ØµÙ‚Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª...', 'info');
                const stickers = generateStickersData(units);
                localStorage.setItem('stickers', JSON.stringify(stickers));
                localStorage.setItem('stickersData', JSON.stringify(stickers)); // For enhanced_stickers_management.html
                addLog(`âœ“ ØªÙ… ØªÙˆÙ„ÙŠØ¯ ${stickers.length} Ù…Ù„ØµÙ‚`, 'success');
                
                // 5. Create complete data object
                const completeData = {
                    units: units,
                    residents: units.filter(u => u.is_occupied).map(u => ({
                        name: u.resident_name,
                        phone: u.resident_phone,
                        unit_name: u.unit_name,
                        building_number: u.building_number,
                        unit_number: u.unit_number,
                        building_type: u.building_description
                    })),
                    buildings: buildings,
                    parking: parking,
                    stickers: stickers,
                    statistics: {
                        total_units: units.length,
                        occupied_units: units.filter(u => u.is_occupied).length,
                        vacant_units: units.filter(u => !u.is_occupied).length,
                        total_apartments: units.filter(u => u.unit_type === 'Ø´Ù‚Ø©').length,
                        total_villas: units.filter(u => u.unit_type === 'ÙÙ„Ø©').length,
                        total_buildings: buildings.length,
                        total_parking: parking.length,
                        total_stickers: stickers.length
                    }
                };
                
                // Save to localStorage
                localStorage.setItem('complete_data', JSON.stringify(completeData));
                
                addLog('ğŸ“ˆ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù†Ø¸Ø§Ù…:', 'info');
                addLog(`- Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙˆØ­Ø¯Ø§Øª: ${completeData.statistics.total_units}`, 'success');
                addLog(`- Ø§Ù„Ø´Ù‚Ù‚: ${completeData.statistics.total_apartments}`, 'success');
                addLog(`- Ø§Ù„ÙÙ„Ù„: ${completeData.statistics.total_villas}`, 'success');
                addLog(`- Ø§Ù„Ù…Ø¨Ø§Ù†ÙŠ: ${completeData.statistics.total_buildings}`, 'success');
                addLog(`- Ø§Ù„Ù…ÙˆØ§Ù‚Ù: ${completeData.statistics.total_parking}`, 'success');
                addLog(`- Ø§Ù„Ù…Ù„ØµÙ‚Ø§Øª: ${completeData.statistics.total_stickers}`, 'success');
                
                addLog('âœ… ØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                addLog('ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªØµÙØ­ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§Øª ÙˆØ³ØªØ¸Ù‡Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'success');
                
                btn.disabled = false;
                
            } catch (error) {
                addLog(`âŒ Ø®Ø·Ø£: ${error.message}`, 'error');
                console.error(error);
                btn.disabled = false;
            }
        }

        function generateBuildingsData() {
            const buildings = [];
            
            // Old buildings (1-30)
            for (let i = 1; i <= 30; i++) {
                buildings.push({
                    id: i,
                    building_number: i,
                    building_name: `Ø¹Ù…Ø§Ø±Ø© ${i}`,
                    building_type: 'Ù‚Ø¯ÙŠÙ…',
                    floors_count: 5,
                    units_per_floor: 4,
                    total_units: 20,
                    occupied_units: Math.floor(Math.random() * 3) + 18,
                    status: 'Ù†Ø´Ø·'
                });
            }
            
            // New buildings (53-56, 61-68, 71-79)
            const newBuildingNumbers = [
                ...Array.from({length: 4}, (_, i) => 53 + i),
                ...Array.from({length: 8}, (_, i) => 61 + i),
                ...Array.from({length: 9}, (_, i) => 71 + i)
            ];
            
            newBuildingNumbers.forEach((num, index) => {
                buildings.push({
                    id: 30 + index + 1,
                    building_number: num,
                    building_name: `Ø¹Ù…Ø§Ø±Ø© ${num}`,
                    building_type: 'Ø¬Ø¯ÙŠØ¯',
                    floors_count: 7,
                    units_per_floor: 3,
                    total_units: 21,
                    occupied_units: Math.floor(Math.random() * 2) + 19,
                    status: 'Ù†Ø´Ø·'
                });
            });
            
            return buildings;
        }

        function generateParkingData() {
            const parking = [];
            let parkingId = 1;
            
            // Generate parking for buildings
            for (let building = 1; building <= 30; building++) {
                for (let spot = 1; spot <= 20; spot++) {
                    parking.push({
                        id: parkingId++,
                        parking_number: `P${building}-${spot}`,
                        building_number: building,
                        spot_number: spot,
                        parking_type: 'Ø®Ø§Øµ',
                        status: Math.random() > 0.2 ? 'Ù…Ø´ØºÙˆÙ„' : 'Ø´Ø§ØºØ±',
                        floor: building < 30 ? 'Ø£Ø±Ø¶ÙŠ' : 'B1'
                    });
                }
            }
            
            // Add public parking spots
            for (let spot = 1; spot <= 50; spot++) {
                parking.push({
                    id: parkingId++,
                    parking_number: `PUB-${spot}`,
                    building_number: null,
                    spot_number: spot,
                    parking_type: 'Ø¹Ø§Ù…',
                    status: Math.random() > 0.3 ? 'Ù…Ø´ØºÙˆÙ„' : 'Ø´Ø§ØºØ±',
                    floor: 'Ø£Ø±Ø¶ÙŠ'
                });
            }
            
            // Add disabled parking spots
            for (let spot = 1; spot <= 10; spot++) {
                parking.push({
                    id: parkingId++,
                    parking_number: `DIS-${spot}`,
                    building_number: null,
                    spot_number: spot,
                    parking_type: 'Ø°ÙˆÙŠ Ø§Ù„Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª',
                    status: Math.random() > 0.7 ? 'Ù…Ø´ØºÙˆÙ„' : 'Ø´Ø§ØºØ±',
                    floor: 'Ø£Ø±Ø¶ÙŠ'
                });
            }
            
            return parking;
        }

        function generateStickersData(units) {
            const stickers = [];
            const occupiedUnits = units.filter(u => u.is_occupied);
            
            // Generate stickers for occupied units
            occupiedUnits.forEach((unit, index) => {
                if (Math.random() > 0.1) { // 90% have stickers
                    const stickerNumber = `STK${String(index + 1).padStart(6, '0')}`;
                    const plateLetters = ['Ø£', 'Ø¨', 'Ø¬', 'Ø¯', 'Ù‡Ù€', 'Ùˆ', 'Ø±', 'Ø³', 'Øµ', 'Ø·', 'Ø¹', 'Ùƒ', 'Ù„', 'Ù…', 'Ù†'];
                    const plate = `${plateLetters[Math.floor(Math.random() * plateLetters.length)]} ${plateLetters[Math.floor(Math.random() * plateLetters.length)]} ${plateLetters[Math.floor(Math.random() * plateLetters.length)]} ${Math.floor(Math.random() * 9000) + 1000}`;
                    
                    stickers.push({
                        id: index + 1,
                        sticker_number: stickerNumber,
                        owner_name: unit.resident_name,
                        plate_number: plate,
                        vehicle_type: getRandomVehicleType(),
                        issue_date: getRandomDate(),
                        expiry_date: getFutureDate(),
                        status: Math.random() > 0.05 ? 'ÙØ¹Ø§Ù„' : 'Ù…Ù†ØªÙ‡ÙŠ',
                        building_number: unit.building_number,
                        unit_number: unit.unit_number,
                        parking_number: unit.parking_number
                    });
                }
            });
            
            return stickers;
        }

        function getRandomVehicleType() {
            const types = [
                'ØªÙˆÙŠÙˆØªØ§ ÙƒØ§Ù…Ø±ÙŠ',
                'Ù‡ÙˆÙ†Ø¯Ø§ÙŠ Ø³ÙˆÙ†Ø§ØªØ§',
                'Ù†ÙŠØ³Ø§Ù† Ø§Ù„ØªÙŠÙ…Ø§',
                'Ù…Ø§Ø²Ø¯Ø§ 6',
                'Ø´ÙØ±ÙˆÙ„ÙŠÙ‡ Ù…Ø§Ù„ÙŠØ¨Ùˆ',
                'ÙÙˆØ±Ø¯ ØªÙˆØ±Ø³',
                'ÙƒÙŠØ§ Ø§ÙˆØ¨ØªÙŠÙ…Ø§',
                'Ù„ÙƒØ²Ø³ ES',
                'Ù…Ø±Ø³ÙŠØ¯Ø³ C-Class',
                'BMW 5 Series'
            ];
            const colors = ['Ø£Ø¨ÙŠØ¶', 'Ø£Ø³ÙˆØ¯', 'ÙØ¶ÙŠ', 'Ø±Ù…Ø§Ø¯ÙŠ', 'Ø£Ø²Ø±Ù‚', 'Ø£Ø­Ù…Ø±'];
            const years = [2018, 2019, 2020, 2021, 2022, 2023, 2024];
            
            return `${types[Math.floor(Math.random() * types.length)]} ${colors[Math.floor(Math.random() * colors.length)]} ${years[Math.floor(Math.random() * years.length)]}`;
        }

        function getRandomDate() {
            const start = new Date(2022, 0, 1);
            const end = new Date(2024, 0, 1);
            const date = new Date(start.getTime() + Math.random() * (end.getTime() - start.getTime()));
            return date.toISOString().split('T')[0];
        }

        function getFutureDate() {
            const date = new Date();
            date.setFullYear(date.getFullYear() + Math.floor(Math.random() * 2) + 1);
            return date.toISOString().split('T')[0];
        }

        // Auto-generate on page load
        addLog('Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù†Ø¸Ø§Ù… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'info');
        addLog('Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± "ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª" Ù„Ø¥Ù†Ø´Ø§Ø¡ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§Ù…Ù„Ø© Ù„Ù„Ù†Ø¸Ø§Ù…', 'info');
    </script>
</body>
</html>
